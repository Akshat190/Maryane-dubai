const Lightbox=(function(){const Handler={properties:{},init:function({exportUrl,hash,tid,redirectUrl}){if(exportUrl==='undefined'||hash==='undefined'||tid==='undefined'||redirectUrl==='undefined'){throw Error('Missing required property')}Handler.properties={exportUrl:exportUrl,hash:hash,tid:tid,redirectUrl:redirectUrl}},register:function(){let headElement=document.getElementsByTagName('head')[0];headElement.addEventListener('lightboxes-ready',function(){let lightboxes=document.getElementsByClassName('landingi-popup-body');for(let lightbox of lightboxes){let lightboxContent=lightbox.innerHTML;lightboxContent=Handler.Replacer.modifyLandingContent(lightboxContent);lightboxContent=Handler.Replacer.modifyButtonSubmissionEndpoints(lightboxContent);lightbox.innerHTML=lightboxContent}})},Replacer:{modifyLandingContent:function(bodyContent){const redirectInputRegex=/(<input type="hidden" name="_redirect" value)="">/g;const formActionRegex=/ action="\/([\s\S]*?)"/g;const popupleadActionRegex=/ action="\/popuplead\/\/([\s\S]*?)"/g;bodyContent=bodyContent.replace(popupleadActionRegex,` action="${Handler.properties.exportUrl }/popuplead/${Handler.properties.tid }/$1?export_hash=${Handler.properties.hash }&tid=${Handler.properties.tid }"`);bodyContent=bodyContent.replace(formActionRegex,` action="${Handler.properties.exportUrl }/$1?export_hash=${Handler.properties.hash }&tid=${Handler.properties.tid }"`);bodyContent=bodyContent.replace(redirectInputRegex,`$1="${Handler.properties.redirectUrl }">`);return bodyContent},modifyButtonSubmissionEndpoints:function(bodyContent){const regularAddressRegex=/ href="(?:(?:\/[^\/]+)|(?:\/+))?(\/+button\/[a-zA-z0-9]{32})"/g;const lightboxAddressRegex=/ href="(?:(?:\/[^\/]+)|(?:\/+))?(\/+button\/[a-zA-z0-9]{32})\?lightbox=([a-z0-9]{8}(?:-[a-z0-9]{4}){3}-[a-z0-9]{12})"/g;bodyContent=bodyContent.replace(lightboxAddressRegex,` href="${Handler.properties.exportUrl }$1?export_hash=${Handler.properties.hash }&tid=${Handler.properties.tid }&lightbox=$2"`);bodyContent=bodyContent.replace(regularAddressRegex,` href="${Handler.properties.exportUrl }$1?export_hash=${Handler.properties.hash }&tid=${Handler.properties.tid }"`);return bodyContent}}};return{init:Handler.init,register:Handler.register}})();
